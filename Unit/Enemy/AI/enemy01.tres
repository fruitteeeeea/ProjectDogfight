[gd_resource type="BehaviorTree" load_steps=35 format=3 uid="uid://c04qvwf7i2xkn"]

[ext_resource type="Script" uid="uid://v5o226aekwua" path="res://ai/tasks/in_combat_area.gd" id="1_1gapl"]
[ext_resource type="Script" uid="uid://crme3j4irdn24" path="res://ai/tasks/return_to_combat_area.gd" id="1_c0ri4"]
[ext_resource type="Script" uid="uid://dqhahvrr7rky6" path="res://ai/tasks/climb_up_or_down.gd" id="3_3rvhi"]
[ext_resource type="Script" uid="uid://b2ks5hmb7npe8" path="res://ai/tasks/enemy_flanking.gd" id="3_7kei1"]
[ext_resource type="Script" uid="uid://ccr43pgd4488l" path="res://ai/tasks/get_first_in_group.gd" id="4_swpx5"]
[ext_resource type="Script" uid="uid://dn7jo2eci56ul" path="res://ai/tasks/enemy_in_range.gd" id="5_31koj"]
[ext_resource type="Script" uid="uid://bv5r8idf0o1t4" path="res://ai/tasks/enemy_approach.gd" id="5_yibc0"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_s64y3"]
var/target/name = &"target"
var/target/type = 4
var/target/value = ""
var/target/hint = 0
var/target/hint_string = ""

[sub_resource type="BBNode" id="BBNode_d80a3"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_axqv5"]
node = SubResource("BBNode_d80a3")
method = &"_enter_combat_area"

[sub_resource type="BTCondition" id="BTCondition_1gapl"]
script = ExtResource("1_1gapl")
combat_area_x_min = -3840.0
combat_area_x_max = 3840.0
combat_area_y_min = -2144.0
combat_area_y_max = 2144.0

[sub_resource type="BTInvert" id="BTInvert_c0ri4"]
children = [SubResource("BTCondition_1gapl")]

[sub_resource type="BTAction" id="BTAction_c0ri4"]
script = ExtResource("1_c0ri4")

[sub_resource type="BTWait" id="BTWait_c0ri4"]

[sub_resource type="BTSequence" id="BTSequence_ioxih"]
custom_name = "CheckPosition"
children = [SubResource("BTCallMethod_axqv5"), SubResource("BTInvert_c0ri4"), SubResource("BTAction_c0ri4"), SubResource("BTWait_c0ri4")]

[sub_resource type="BTAction" id="BTAction_yibc0"]
script = ExtResource("4_swpx5")
group = &"player"
output_var = &"target"

[sub_resource type="BTCondition" id="BTCondition_d80a3"]
script = ExtResource("5_31koj")
distance_min = 300.0
distance_max = 450.0
target_var = &"target"

[sub_resource type="BBNode" id="BBNode_7kei1"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_7kei1"]
node = SubResource("BBNode_7kei1")
method = &"_enter_flank_state"

[sub_resource type="BTAction" id="BTAction_d80a3"]
script = ExtResource("4_swpx5")
group = &"player"
output_var = &"target"

[sub_resource type="BTAction" id="BTAction_31koj"]
script = ExtResource("3_7kei1")
target_var = &"target"

[sub_resource type="BTRandomWait" id="BTRandomWait_31koj"]
max_duration = 1.5

[sub_resource type="BTSequence" id="BTSequence_7kei1"]
children = [SubResource("BTAction_yibc0"), SubResource("BTCondition_d80a3"), SubResource("BTCallMethod_7kei1"), SubResource("BTAction_d80a3"), SubResource("BTAction_31koj"), SubResource("BTRandomWait_31koj")]

[sub_resource type="BTCooldown" id="BTCooldown_7kei1"]
children = [SubResource("BTSequence_7kei1")]

[sub_resource type="BBNode" id="BBNode_31koj"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_d80a3"]
node = SubResource("BBNode_31koj")
method = &"_enter_attack_state"

[sub_resource type="BTAction" id="BTAction_swpx5"]
script = ExtResource("3_3rvhi")
target_var = &"target"
tolerance = 30.0

[sub_resource type="BTAction" id="BTAction_7kei1"]
script = ExtResource("5_yibc0")
target_var = &"target"
tolerance = 150.0

[sub_resource type="BTSequence" id="BTSequence_yibc0"]
custom_name = "Aattacck"
children = [SubResource("BTAction_swpx5"), SubResource("BTAction_7kei1")]

[sub_resource type="BTTimeLimit" id="BTTimeLimit_31koj"]
children = [SubResource("BTSequence_yibc0")]

[sub_resource type="BTSequence" id="BTSequence_swpx5"]
custom_name = "ClimbToSameHorizontal"
children = [SubResource("BTCallMethod_d80a3"), SubResource("BTTimeLimit_31koj")]

[sub_resource type="BTSelector" id="BTSelector_swpx5"]
custom_name = "AttackState"
children = [SubResource("BTSequence_swpx5")]

[sub_resource type="BTSelector" id="BTSelector_7kei1"]
custom_name = "NormalState"
children = [SubResource("BTCooldown_7kei1"), SubResource("BTSelector_swpx5")]

[sub_resource type="BTSelector" id="BTSelector_ioxih"]
children = [SubResource("BTSequence_ioxih"), SubResource("BTSelector_7kei1")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_s64y3")
root_task = SubResource("BTSelector_ioxih")
