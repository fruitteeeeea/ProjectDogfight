[gd_resource type="BehaviorTree" load_steps=63 format=3 uid="uid://c04qvwf7i2xkn"]

[ext_resource type="Script" uid="uid://v5o226aekwua" path="res://ai/tasks/in_combat_area.gd" id="1_1gapl"]
[ext_resource type="Script" uid="uid://crme3j4irdn24" path="res://ai/tasks/enemy_return_to_combat_area.gd" id="2_d80a3"]
[ext_resource type="Script" uid="uid://dqhahvrr7rky6" path="res://ai/tasks/climb_up_or_down.gd" id="3_3rvhi"]
[ext_resource type="Script" uid="uid://nlwph1f7h1al" path="res://ai/tasks/enemy_do_a_roll.gd" id="3_4cm3n"]
[ext_resource type="Script" uid="uid://b2ks5hmb7npe8" path="res://ai/tasks/enemy_flanking.gd" id="3_7kei1"]
[ext_resource type="Script" uid="uid://drbcmj0danqlm" path="res://ai/tasks/enemy_move_straight_line.gd" id="3_axqv5"]
[ext_resource type="Script" uid="uid://cici70d66h5xq" path="res://ai/tasks/enemy_change_direction.gd" id="3_d80a3"]
[ext_resource type="Script" uid="uid://ccr43pgd4488l" path="res://ai/tasks/get_first_in_group.gd" id="4_swpx5"]
[ext_resource type="Script" uid="uid://dn7jo2eci56ul" path="res://ai/tasks/enemy_in_range.gd" id="5_31koj"]
[ext_resource type="Script" uid="uid://bv5r8idf0o1t4" path="res://ai/tasks/enemy_approach.gd" id="5_yibc0"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_s64y3"]
var/target/name = &"target"
var/target/type = 4
var/target/value = ""
var/target/hint = 0
var/target/hint_string = ""

[sub_resource type="BTComment" id="BTComment_4cm3n"]
custom_name = "确保敌人不会离开地图区域 "

[sub_resource type="BBNode" id="BBNode_d80a3"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_axqv5"]
node = SubResource("BBNode_d80a3")
method = &"_enter_combat_area"

[sub_resource type="BTCondition" id="BTCondition_1gapl"]
script = ExtResource("1_1gapl")

[sub_resource type="BTInvert" id="BTInvert_c0ri4"]
children = [SubResource("BTCondition_1gapl")]

[sub_resource type="BTAction" id="BTAction_c0ri4"]
script = ExtResource("2_d80a3")

[sub_resource type="BTWait" id="BTWait_c0ri4"]
duration = 0.1

[sub_resource type="BTSequence" id="BTSequence_ioxih"]
custom_name = "CheckWorldPosition"
children = [SubResource("BTComment_4cm3n"), SubResource("BTCallMethod_axqv5"), SubResource("BTInvert_c0ri4"), SubResource("BTAction_c0ri4"), SubResource("BTWait_c0ri4")]

[sub_resource type="BTSequence" id="BTSequence_rg4p3"]
custom_name = "CheckPlayerPosition"

[sub_resource type="BBNode" id="BBNode_31koj"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_d80a3"]
node = SubResource("BBNode_31koj")
method = &"_enter_attack_state"

[sub_resource type="BTAction" id="BTAction_rg4p3"]
script = ExtResource("4_swpx5")
group = &"player"
output_var = &"target"

[sub_resource type="BTAction" id="BTAction_swpx5"]
script = ExtResource("3_3rvhi")
target_var = &"target"
tolerance = 30.0

[sub_resource type="BTAction" id="BTAction_7kei1"]
script = ExtResource("5_yibc0")
target_var = &"target"
tolerance = 150.0

[sub_resource type="BTSequence" id="BTSequence_yibc0"]
custom_name = "Aattacck"
children = [SubResource("BTAction_swpx5"), SubResource("BTAction_7kei1")]

[sub_resource type="BTTimeLimit" id="BTTimeLimit_31koj"]
children = [SubResource("BTSequence_yibc0")]

[sub_resource type="BTSequence" id="BTSequence_swpx5"]
custom_name = "ClimbToSameHorizontal"
children = [SubResource("BTCallMethod_d80a3"), SubResource("BTAction_rg4p3"), SubResource("BTTimeLimit_31koj")]

[sub_resource type="BTSelector" id="BTSelector_swpx5"]
custom_name = "AttackState"
children = [SubResource("BTSequence_swpx5")]

[sub_resource type="BTAction" id="BTAction_yibc0"]
script = ExtResource("4_swpx5")
group = &"player"
output_var = &"target"

[sub_resource type="BTCondition" id="BTCondition_d80a3"]
script = ExtResource("5_31koj")
distance_min = 300.0
distance_max = 450.0
target_var = &"target"

[sub_resource type="BBNode" id="BBNode_7kei1"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_7kei1"]
node = SubResource("BBNode_7kei1")
method = &"_enter_flank_state"

[sub_resource type="BTComment" id="BTComment_457ul"]
custom_name = "敌人绕圈"

[sub_resource type="BTAction" id="BTAction_457ul"]
children = [SubResource("BTComment_457ul")]
script = ExtResource("3_4cm3n")

[sub_resource type="BTConsolePrint" id="BTConsolePrint_4cm3n"]
text = "敌人绕圈"

[sub_resource type="BTSequence" id="BTSequence_4cm3n"]
custom_name = "DoARoll"
children = [SubResource("BTAction_457ul"), SubResource("BTConsolePrint_4cm3n")]

[sub_resource type="BTProbability" id="BTProbability_457ul"]
children = [SubResource("BTSequence_4cm3n")]

[sub_resource type="BTComment" id="BTComment_rg4p3"]
custom_name = "敌人反方向逃跑"

[sub_resource type="BTAction" id="BTAction_31koj"]
children = [SubResource("BTComment_rg4p3")]
script = ExtResource("3_7kei1")
target_var = &"target"

[sub_resource type="BTConsolePrint" id="BTConsolePrint_457ul"]
text = "敌人反方向逃跑"

[sub_resource type="BTSequence" id="BTSequence_457ul"]
custom_name = "Flanking"
children = [SubResource("BTAction_31koj"), SubResource("BTConsolePrint_457ul")]

[sub_resource type="BTSelector" id="BTSelector_4cm3n"]
children = [SubResource("BTProbability_457ul"), SubResource("BTSequence_457ul")]

[sub_resource type="BTRandomWait" id="BTRandomWait_31koj"]
max_duration = 1.5

[sub_resource type="BTSequence" id="BTSequence_7kei1"]
children = [SubResource("BTAction_yibc0"), SubResource("BTCondition_d80a3"), SubResource("BTCallMethod_7kei1"), SubResource("BTSelector_4cm3n"), SubResource("BTRandomWait_31koj")]

[sub_resource type="BTCooldown" id="BTCooldown_7kei1"]
duration = 5.0
children = [SubResource("BTSequence_7kei1")]

[sub_resource type="BTSelector" id="BTSelector_7kei1"]
custom_name = "NormalState"
children = [SubResource("BTSelector_swpx5"), SubResource("BTCooldown_7kei1")]

[sub_resource type="BBNode" id="BBNode_axqv5"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_4cm3n"]
node = SubResource("BBNode_axqv5")
method = &"_enter_flank_state"

[sub_resource type="BTAction" id="BTAction_4cm3n"]
script = ExtResource("3_axqv5")

[sub_resource type="BTRandomWait" id="BTRandomWait_axqv5"]

[sub_resource type="BTSequence" id="BTSequence_axqv5"]
custom_name = "MoveStraight"
children = [SubResource("BTCallMethod_4cm3n"), SubResource("BTAction_4cm3n"), SubResource("BTRandomWait_axqv5")]

[sub_resource type="BTProbability" id="BTProbability_axqv5"]
children = [SubResource("BTSequence_axqv5")]

[sub_resource type="BBNode" id="BBNode_4cm3n"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_457ul"]
node = SubResource("BBNode_4cm3n")
method = &"_enter_flank_state"

[sub_resource type="BTAction" id="BTAction_axqv5"]
script = ExtResource("3_d80a3")

[sub_resource type="BTRandomWait" id="BTRandomWait_d80a3"]

[sub_resource type="BTSequence" id="BTSequence_d80a3"]
custom_name = "ChangeDirection"
children = [SubResource("BTCallMethod_457ul"), SubResource("BTAction_axqv5"), SubResource("BTRandomWait_d80a3")]

[sub_resource type="BTSelector" id="BTSelector_d80a3"]
custom_name = "Movement"
children = [SubResource("BTProbability_axqv5"), SubResource("BTSequence_d80a3")]

[sub_resource type="BTProbability" id="BTProbability_4cm3n"]
run_chance = 0.0
children = [SubResource("BTSelector_d80a3")]

[sub_resource type="BTRandomSequence" id="BTRandomSequence_4cm3n"]

[sub_resource type="BTSelector" id="BTSelector_ioxih"]
children = [SubResource("BTSequence_ioxih"), SubResource("BTSequence_rg4p3"), SubResource("BTSelector_7kei1"), SubResource("BTProbability_4cm3n"), SubResource("BTRandomSequence_4cm3n")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_s64y3")
root_task = SubResource("BTSelector_ioxih")
